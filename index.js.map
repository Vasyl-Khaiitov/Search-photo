{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = (axios.defaults.API_KEY = '49359087-343ead2b9467da8fb57304bcb');\nconst BASE_URL = (axios.defaults.baseURL = 'https://pixabay.com/api/');\n\nexport async function requestServer(query, currentPage) {\n  const options = {\n    params: {\n      key: API_KEY,\n      q: query.trim(),\n      image_type: 'photo',\n      orientation: 'horizontal',\n      page: currentPage,\n      per_page: 15,\n      safesearch: 'true',\n    },\n  };\n\n  const response = await axios.get(BASE_URL, options);\n  const { hits, totalHits } = response.data;\n\n  return { hits, totalHits };\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nlet lightbox = null;\n\nexport function clearGallery() {\n  gallery.innerHTML = '';\n}\n\nexport function updateGallery(hits) {\n  markupPhoto(hits);\n}\n\nexport function showButton() {\n  btnMore.classList.remove('hidden');\n}\n\nexport function hideButton() {\n  btnMore.classList.add('hidden');\n}\n\nconst gallery = document.querySelector('.gallery');\nexport const btnMore = document.querySelector('.btn-more');\n\nexport function markupPhoto(hits = []) {\n  const galleryMarkup = hits\n    .map(\n      hit =>\n        `<li class=\"gallery-item\">\n        <a href=\"${hit.largeImageURL}\" class=\"gallery-item-link\">\n        <img class=\"gallery-img\" src=\"${hit.webformatURL}\" alt=\"${hit.tags}\" loading=\"lazy\" />\n        </a>\n        <div class=\"text-info\">\n        <p><b>Likes:</b>${hit.likes}</p>\n        <p><b>Views:</b>${hit.views}</p>\n        <p><b>Comments:</b>${hit.comments}</p>\n        <p><b>Downloads:</b>${hit.downloads}</p>\n        </div>\n        </li>`\n    )\n    .join('');\n  gallery.insertAdjacentHTML('beforeend', galleryMarkup);\n\n  if (!lightbox) {\n    lightbox = new SimpleLightbox('.gallery a', {\n      caption: true,\n      captionType: 'attr',\n      captionsData: 'alt',\n      captionPosition: 'bottom',\n      captionDelay: 250,\n    });\n  } else {\n    lightbox.refresh();\n  }\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport { requestServer } from './js/pixabay-api';\nimport {\n  clearGallery,\n  updateGallery,\n  showButton,\n  hideButton,\n  btnMore,\n} from './js/render-functions';\n\nconst form = document.querySelector('.form');\nconst loaderTop = document.querySelector('.loader');\nconst loaderBottom = document.querySelector('.loader-bottom');\n\nfunction showLoaderTop() {\n  loaderTop.classList.remove('hidden');\n}\n\nfunction hideLoaderTop() {\n  loaderTop.classList.add('hidden');\n}\nfunction showLoaderBottom() {\n  loaderBottom.classList.remove('hidden');\n}\n\nfunction hideLoaderBottom() {\n  loaderBottom.classList.add('hidden');\n}\n\nbtnMore.addEventListener('click', onClick);\nform.addEventListener('submit', onSubmit);\n\nlet correctValueText = null;\nlet currentPage = 1;\n\nexport async function onSubmit(event) {\n  event.preventDefault();\n\n  currentPage = 1;\n  clearGallery();\n  const form = event.currentTarget;\n\n  const { searchText } = form.elements;\n  correctValueText = searchText.value.trim();\n\n  if (!correctValueText) {\n    iziToast.show({\n      title: '⛔',\n      message: 'Please write a search query!',\n      color: 'yellow',\n      position: 'topRight',\n    });\n    return;\n  }\n\n  showLoaderTop();\n  hideButton();\n\n  try {\n    const { hits, totalHits } = await requestServer(\n      correctValueText,\n      currentPage\n    );\n\n    if (!Array.isArray(hits)) {\n      console.error('Invalid response structure. Hits is not an array.');\n      iziToast.show({\n        title: '⚠️',\n        message: 'Unexpected response format. Please try again later!',\n        color: 'yellow',\n        position: 'topRight',\n      });\n      hideLoaderTop();\n      return;\n    }\n\n    if (hits.length === 0) {\n      iziToast.show({\n        title: '❌',\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        color: 'red',\n        position: 'topRight',\n      });\n      hideLoaderTop();\n      return;\n    }\n\n    updateGallery(hits);\n\n    if (hits.length < totalHits) {\n      showButton();\n    } else {\n      hideButton();\n    }\n\n    form.reset();\n  } catch (error) {\n    let errorMessage = 'An unexpected error occurred. Please try again later!';\n\n    if (error.response) {\n      errorMessage = `Server Error: ${\n        error.response.data.message || error.message\n      }`;\n    } else if (error.request) {\n      errorMessage =\n        'Network Error: Failed to reach the server. Please check your internet connection.';\n    }\n\n    iziToast.show({\n      title: '⚠️',\n      message: errorMessage,\n      color: 'red',\n      position: 'topRight',\n    });\n    console.error('Error:', error.message);\n  }\n  hideLoaderTop();\n}\n\nasync function onClick(event) {\n  currentPage += 1;\n\n  showLoaderBottom();\n  try {\n    const { hits, totalHits } = await requestServer(\n      correctValueText,\n      currentPage\n    );\n  \n\n    if (hits.length === 0) {\n      hideButton();\n    } else {\n      updateGallery(hits);\n\n      const displayedCards = currentPage * 15;\n\n      if (displayedCards >= totalHits) {\n        iziToast.show({\n          title: 'ℹ️',\n          message: \"We're sorry, but you've reached the end of search results\",\n          color: 'blue',\n          position: 'topRight',\n        });\n        hideButton();\n      }\n    }\n\n    scrollImages();\n  } catch (error) {\n    console.error('Error during fetching data:', error.message);\n    iziToast.show({\n      title: '⚠️',\n      message: 'An error occurred. Please try again later!',\n      color: 'red',\n      position: 'topRight',\n    });\n  } finally {\n    hideLoaderBottom();\n  }\n}\n\nfunction scrollImages() {\n  const ImageCard = document.querySelector('.gallery-img');\n\n  if (ImageCard) {\n    const cardHeight = ImageCard.getBoundingClientRect().height;\n\n    window.scrollBy({\n      top: cardHeight * 2.5,\n      behavior: 'smooth',\n    });\n  }\n}\n"],"names":["API_KEY","axios","BASE_URL","requestServer","query","currentPage","options","response","hits","totalHits","lightbox","clearGallery","gallery","updateGallery","markupPhoto","showButton","btnMore","hideButton","galleryMarkup","hit","SimpleLightbox","form","loaderTop","loaderBottom","showLoaderTop","hideLoaderTop","showLoaderBottom","hideLoaderBottom","onClick","onSubmit","correctValueText","event","searchText","iziToast","error","errorMessage","scrollImages","ImageCard","cardHeight"],"mappings":"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"}